(this.webpackJsonplambdavibe=this.webpackJsonplambdavibe||[]).push([[0],{115:function(e,t,n){},116:function(e,t,n){},117:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),c=n(58),s=n.n(c),r=n(3),o=n.n(r),l=n(6),d=n(7),u=n(30),b=n(10),j=n(12),m=n(119),h=n(2),f=n(8),v=function e(t,n){Object(h.a)(this,e),this.type=void 0,this.args=void 0,this.type=t,this.args=Object(f.d)(n)};function x(e,t){var n=t.type,i=t.args;console.debug("".concat(n));var a=function(){switch(n){case"SET_SOCKET":var t=e.get("socket");return t&&t.close(),e.set("socket",i.get("socket"));case"DELETE_SOCKET":return e.delete("socket");case"SET_SONGS":var a=i.get("songs");return e.set("songs",a);case"PLAY_SONG":var c=e.get("songs").find((function(e){return e.get("id")===i.get("id")}));console.log(c);var s=c.get("notes");return e.set("notes",s).set("playingSong",c);case"STOP_SONG":return e.delete("notes");case"SET_LOCATION":var r,o=i.getIn(["location","pathname"],""),l=i.getIn(["location","search"],""),d=o.substring(1),u=null!==(r=new URLSearchParams(l.substring(1)).get("visualizer"))&&void 0!==r?r:"",b=e.get("instruments"),j=e.get("visualizers"),m=b.find((function(e){return e.name===d})),h=j.find((function(e){return e.name===u}));return e.set("instrument",m).set("visualizer",h);default:return console.error("type unknown: ".concat(n,"\n"),i.toJS()),e}}();return console.debug(a.update("socket",(function(e){return e?"[socket]":e})).toJS()),a}var O=n(5),p=function e(t,n){Object(h.a)(this,e),this.name=void 0,this.component=void 0,this.name=t,this.component=n};function g(e){var t=e.name;return Object(O.jsx)("div",{className:"w-100 h3 bb b--light-gray flex justify-between items-center ph4",children:Object(O.jsx)("div",{children:t})})}var w=function(e){var t=e.instrument,n=e.state,a=e.dispatch,c=t.component,s=Object(i.useState)(new j.c({oscillator:{type:"sine"}}).toDestination()),r=Object(d.a)(s,2),o=r[0],l=r[1],u=n.get("notes");return Object(i.useEffect)((function(){if(u&&o){var e=u.split(" "),t=e.map((function(e,t){return{idx:t,time:"+".concat(t/4),note:e,velocity:1}}));return new j.b((function(t,n){o.triggerAttackRelease(n.note,"4n",t,n.velocity),n.idx===e.length-1&&a(new v("STOP_SONG"))}),t).start(0),j.d.start(),function(){j.d.cancel()}}return function(){}}),[u,o,a]),Object(O.jsxs)("div",{children:[Object(O.jsx)(g,{name:t.name}),Object(O.jsx)("div",{className:"bg-white absolute right-0 left-0",style:{top:"4rem"},children:Object(O.jsx)(c,{name:t.name,state:n,dispatch:a,synth:o,setSynth:l})})]})},N=n(23),y=n.n(N),k=n(118),S=function(e){var t=e.title,n=e.children;return Object(O.jsxs)("div",{className:"flex flex-column bb b--light-gray pa3 customHeight",children:[Object(O.jsxs)("div",{className:"fw7 mb2",children:[t," "]}),Object(O.jsx)("div",{className:"flex-auto overflow-scroll",children:n})]})};function C(e){var t=e.to,n=e.text,i=e.active,a=e.onClick;return Object(O.jsx)(u.b,{to:t,className:"no-underline",children:Object(O.jsxs)("div",{className:y()("f6 flex items-center black",{fw7:i}),onClick:a,children:[i?Object(O.jsx)(k.b,{className:"mr1"}):Object(O.jsx)(k.a,{className:"mr1"}),Object(O.jsx)("div",{className:"dim",children:n})]})})}function D(e){var t,n=e.state,i=n.get("instruments"),a=null===(t=n.get("instrument"))||void 0===t?void 0:t.name,c=Object(b.f)();return Object(O.jsx)(S,{title:"Instruments",children:i.map((function(e){return Object(O.jsx)(C,{to:"/".concat(e.name).concat(c.search),text:e.name,active:e.name===a,onClick:function(){return console.log(e.name)}},e.name)}))})}function E(e){var t,n=e.state,i=n.get("visualizers"),a=null===(t=n.get("visualizer"))||void 0===t?void 0:t.name,c=Object(b.f)();return Object(O.jsx)(S,{title:"Visualizers",children:i.map((function(e){return Object(O.jsx)(C,{to:{pathname:c.pathname,search:"?visualizer=".concat(e.name)},text:e.name,active:e.name===a,onClick:function(){return console.log(e.name)}},e.name)}))})}function _(e){var t=e.state,n=e.dispatch,a=Object(i.useState)(Object(f.a)()),c=Object(d.a)(a,2),s=c[0],r=c[1];Object(i.useEffect)((function(){var e=t.get("songs",Object(f.a)());e.size>0&&r(e)}),[t]);return Object(O.jsxs)(i.Fragment,{children:[Object(O.jsx)(T,{onChangeHandler:function(e){var n,i=null!==(n=e.target.value)&&void 0!==n?n:"",a=i?s.filter((function(e){return e.get("songTitle").toUpperCase().startsWith(i.toUpperCase())})):t.get("songs",Object(f.a)());a&&r(a)}}),Object(O.jsx)(S,{title:"Playlist",children:s.map((function(e){return Object(O.jsxs)("div",{className:"f6 pointer underline flex items-center no-underline i dim",onClick:function(){return n(new v("PLAY_SONG",{id:e.get("id")}))},children:[Object(O.jsx)(m.a,{className:"mr1"}),e.get("songTitle")]},e.get("id"))}))})]})}function T(e){var t=e.onChangeHandler;return Object(O.jsxs)("div",{className:"pa2 b--light-gray mb1 mr3",children:[Object(O.jsx)("h4",{className:"fw7 mb2",children:"Search songs"}),Object(O.jsx)("input",{type:"text",maxLength:50,onChange:t})]})}function z(e){var t,n,a,c=e.state.get("playingSong",Object(f.d)({})).toJSON();return Object(O.jsx)(i.Fragment,{children:c.songTitle&&Object(O.jsxs)("div",{className:"songDetails overflow-scroll",children:[Object(O.jsx)("h3",{className:"fw7 mb2",children:c.songTitle}),Object(O.jsxs)("div",{className:"songDetails__element",children:[Object(O.jsx)("span",{children:Object(O.jsx)("b",{children:"Artist :"})}),Object(O.jsx)("span",{className:"songDetails__element-detail",children:null!==(t=c.artist)&&void 0!==t?t:"Not Available"})]}),Object(O.jsxs)("div",{className:"songDetails__element",children:[Object(O.jsx)("span",{children:Object(O.jsx)("b",{children:"Album : "})}),Object(O.jsx)("span",{className:"songDetails__element-detail",children:null!==(n=c.album)&&void 0!==n?n:"Not Available"})]}),Object(O.jsxs)("div",{className:"songDetails__element",children:[Object(O.jsx)("span",{children:Object(O.jsx)("b",{children:"Genre : "})}),Object(O.jsx)("span",{className:"songDetails__element-detail",children:null!==(a=c.genre)&&void 0!==a?a:"Not Available"})]})]})})}function M(e){var t=e.state,n=e.dispatch;return Object(O.jsxs)("div",{className:"absolute top-0 left-0 bottom-0 w5 z-1 shadow-1 bg-white flex flex-column",children:[Object(O.jsx)("div",{className:"h3 fw7 f5 flex items-center pl3 bb b--light-gray",children:"Temp Instrument"}),Object(O.jsxs)("div",{className:"flex-auto",children:[Object(O.jsx)(D,{state:t,dispatch:n}),Object(O.jsx)(E,{state:t,dispatch:n}),Object(O.jsx)(_,{state:t,dispatch:n}),Object(O.jsx)(z,{state:t,dispatch:n})," "]})]})}var A=n(60),I=n.n(A),G=function e(t,n){Object(h.a)(this,e),this.name=void 0,this.draw=void 0,this.name=t,this.draw=n};function P(e){var t=e.visualizer,n=t.name,a=t.draw,c=Object(i.useMemo)((function(){return new j.a("waveform",256)}),[]),s=Object(i.useCallback)((function(e){var t=window.innerWidth,n=window.innerHeight/2;e.resizeCanvas(t,n,!1)}),[]);Object(i.useEffect)((function(){return j.e().volume.value=-5,j.e().connect(c),function(){j.e().disconnect(c)}}),[c]);return Object(O.jsxs)("div",{className:"bg-black absolute bottom-0 right-0 left-0 h-50",children:[Object(O.jsx)("div",{className:"z-1 absolute left-0 top-0 pa4 white f5",children:n}),Object(O.jsx)(I.a,{setup:function(e,t){var n=window.innerWidth,i=window.innerHeight/2;e.createCanvas(n,i,e.WEBGL).parent(t)},draw:function(e){return a(e,c)},windowResized:s})]})}function L(e){var t=e.state,n=e.dispatch,i=t.get("instrument");return Object(O.jsx)("div",{children:i&&Object(O.jsx)(w,{state:t,dispatch:n,instrument:i})})}function R(e){var t=e.state.get("visualizer");return Object(O.jsx)("div",{children:t&&Object(O.jsx)(P,{visualizer:t},t.name)})}function W(e){var t=e.state,n=e.dispatch;return Object(O.jsxs)("div",{className:"absolute right-0 bottom-0 top-0 flex flex-column",style:{left:"16rem"},children:[Object(O.jsx)(L,{state:t,dispatch:n}),Object(O.jsx)(R,{state:t,dispatch:n})]})}function B(){return Object(O.jsx)("div",{className:"absolute right-0 bottom-0 top-0 flex flex-column items-center justify-center",style:{left:"16rem"},children:Object(O.jsxs)("div",{className:"mw6 lh-copy mb4",children:[Object(O.jsx)(m.b,{}),Object(O.jsx)("div",{className:"f3 fw7 mb2",children:"Welcome to the case study."}),Object(O.jsx)("div",{className:"f4 mb3",children:"Select an instrument and a visualizer on the left to serve some fresh beats."}),Object(O.jsx)("div",{className:"f5",children:"The UI is yours to design. Express yourself."})]})})}function F(e){var t=e.state,n=e.dispatch,a=Object(b.f)(),c=!t.get("instrument");return console.log("INSTRUMENT",c),Object(i.useEffect)((function(){n(new v("SET_LOCATION",{location:a}))}),[n,a]),Object(O.jsxs)("div",{className:"fixed top-0 left-0 h-100 w-100 bg-white",onClick:function(){return j.f()},children:[Object(O.jsx)(M,{state:t,dispatch:n}),c?Object(O.jsx)(B,{}):Object(O.jsx)(W,{state:t,dispatch:n})]})}function H(e){var t=e.note,n=e.synth,i=e.minor,a=e.index;return Object(O.jsx)("div",{onMouseDown:function(){return null===n||void 0===n?void 0:n.triggerAttack("".concat(t))},onMouseUp:function(){return null===n||void 0===n?void 0:n.triggerRelease("+0.25")},className:y()("ba pointer absolute dim",{"bg-black black h3":i,"black bg-white h4":!i}),style:{top:0,left:"".concat(2*a,"rem"),zIndex:i?1:0,width:i?"1.5rem":"2rem",marginLeft:i?"0.25rem":0}})}function U(e){var t=e.title,n=e.onClick,i=e.active;return Object(O.jsx)("div",{onClick:n,className:y()("dim pointer ph2 pv1 ba mr2 br1 fw7 bw1",{"b--black black":i,"gray b--light-gray":!i}),children:t})}var V=new p("Piano",(function(e){var t=e.synth,n=e.setSynth,i=Object(f.a)([{note:"C",idx:0},{note:"Db",idx:.5},{note:"D",idx:1},{note:"Eb",idx:1.5},{note:"E",idx:2},{note:"F",idx:3},{note:"Gb",idx:3.5},{note:"G",idx:4},{note:"Ab",idx:4.5},{note:"A",idx:5},{note:"Bb",idx:5.5},{note:"B",idx:6}]),a=Object(f.a)(["sine","sawtooth","square","triangle","fmsine","fmsawtooth","fmtriangle","amsine","amsawtooth","amtriangle"]);return Object(O.jsxs)("div",{className:"pv4",children:[Object(O.jsx)("div",{className:"relative dib h4 w-100 ml4",children:Object(f.c)(2,7).map((function(e){return i.map((function(n){var i=-1!==n.note.indexOf("b"),a="".concat(n.note).concat(e);return Object(O.jsx)(H,{note:a,synth:t,minor:i,octave:e,index:7*(e-2)+n.idx},a)}))}))}),Object(O.jsx)("div",{className:"pl4 pt4 flex",children:a.map((function(e){return Object(O.jsx)(U,{title:e,onClick:function(){return t=e,void n((function(e){return e.disconnect(),new j.c({oscillator:{type:t}}).toDestination()}));var t},active:(null===t||void 0===t?void 0:t.oscillator.type)===e},e)}))})]})})),J=new G("Waveform",(function(e,t){var n=window.innerWidth,i=window.innerHeight/2,a=Math.min(n,i);e.background(0,0,0,255),e.strokeWeight(.01*a),e.stroke(255,255,255,255),e.noFill();var c=t.getValue();e.beginShape();for(var s=0;s<c.length;s++){var r=c[s],o=e.map(s-c.length/2,0,c.length-1,0,n),l=i/16+r*i;e.vertex(o,l)}e.endShape()})),K=new G("RGBCircles (developer-soni)",(function(e,t){var n=150,i=150,a=["#fff700","#4000ff","#00ff08","#ff0000"],c=a[Math.floor(Math.random()*(a.length+1))];e.background("#383737"),e.stroke(String(c));var s=t.getValue();e.beginShape();for(var r=0;r<Math.min(s.length,255);r++)for(var o=s[r],l=e.map(r,0,s.length-1,0,75),d=e.map(r,0,s.length-1,0,75),u=e.map(r,0,l,-4*Math.PI,4*Math.PI)*(l/n)+e.map(r,0,d,-4*Math.PI,4*Math.PI)*(d/i),b=0;b<10;b++){var j=-600-75*e.cos(2*Math.PI*o+u),m=-75-75*e.sin(2*Math.PI*-1*o+u);e.circle(j+115*b,m,5),e.circle(j+115*b,m+150,5)}e.endShape()}));var Y=new G("Dub (adam-bel)",(function(e,t){var n=window.innerWidth,i=window.innerHeight/2,a=Math.min(n,i),c=["blue","white","yellow","red"];e.background("black"),e.strokeWeight(.01*a);var s=t.getValue();e.beginShape();for(var r=0;r<c.length;r++){e.translate(-170*r,17),e.rotateX(.01*e.frameCount*r),e.rotateY(.03*e.frameCount*r),e.stroke(c[r]),e.fill(c[r]);for(var o=0;o<s.length;o++){var l=s[o];e.box(100*l*(r+1),100*l*(r+1),100*l*(r+1))}}e.endShape()})),q=n.p+"static/media/flute.dc30191d.png";function X(e){var t=e.note,n=e.synth,i=e.minor,a=e.index;return Object(O.jsx)("div",{onMouseDown:function(){return null===n||void 0===n?void 0:n.triggerAttack("".concat(t))},onMouseUp:function(){return null===n||void 0===n?void 0:n.triggerRelease("+0.25")},className:y()("ba pointer absolute dim",{"bg-black black h3":i,"black bg-white h4":!i}),style:{top:0,left:"".concat(2*a,"rem"),zIndex:i?1:0,width:i?"1.5rem":"2rem",marginLeft:i?"0.25rem":0}})}var Q=new p("Flute (developer-soni)",(function(e){var t=e.synth,n=e.setSynth,a=Object(f.a)([{note:"C",idx:0},{note:"Db",idx:.5},{note:"D",idx:1},{note:"Eb",idx:1.5},{note:"E",idx:2},{note:"F",idx:3},{note:"Gb",idx:3.5},{note:"G",idx:4},{note:"Ab",idx:4.5},{note:"A",idx:5},{note:"Bb",idx:5.5},{note:"B",idx:6}]);return Object(i.useEffect)((function(){n((function(e){return e.disconnect(),new j.c({volume:7,detune:0,portamento:0,envelope:{attack:1,attackCurve:"cosine",decay:2,decayCurve:"linear",release:1,releaseCurve:"exponential",sustain:0},oscillator:{partialCount:3,partials:[48225308641975394e-21,.007236810378086416,1],phase:3,type:"fatcustom",count:5,spread:1}}).toDestination()}))}),[n]),Object(O.jsxs)("div",{className:"pv4",children:[Object(O.jsx)("div",{className:"image",children:Object(O.jsx)("img",{src:q,alt:"Flute"})}),Object(O.jsx)("div",{className:"relative dib h4 w-100 ml4",children:Object(f.c)(2,7).map((function(e){return a.map((function(n){var i=-1!==n.note.indexOf("b"),a="".concat(n.note).concat(e);return Object(O.jsx)(X,{note:a,synth:t,minor:i,octave:e,index:7*(e-2)+n.idx},a)}))}))})]})})),Z=n.p+"static/media/violin.35c8fedd.jpg";function $(e){var t=e.note,n=e.synth,i=e.minor,a=(e.index,e.topDi),c=e.leftDi,s=e.rota;return Object(O.jsx)("div",{style:{transform:s},children:Object(O.jsx)("div",{onMouseDown:function(){return null===n||void 0===n?void 0:n.triggerAttack("".concat(t))},onMouseUp:function(){return null===n||void 0===n?void 0:n.triggerRelease("+0.1")},className:y()("ba pointer absolute dim"),style:{top:a,transform:"rotate(0deg)",left:"".concat(c,"rem"),zIndex:0,marginLeft:i?"0.25rem":0,background:"#C8C9C5",height:"10px",width:"20px",borderRadius:"6px"}})})}var ee=new p("Violin (adam-bel)",(function(e){var t=e.synth,n=e.setSynth,a=Object(f.a)([{note:"C",idx:0},{note:"Db",idx:.5},{note:"D",idx:1},{note:"Eb",idx:1.5},{note:"E",idx:2},{note:"F",idx:3},{note:"Gb",idx:3.5},{note:"G",idx:4},{note:"Ab",idx:4.5},{note:"A",idx:5},{note:"Bb",idx:5.5},{note:"B",idx:6}]);return Object(i.useEffect)((function(){n((function(e){return e.disconnect(),new j.c({volume:5,detune:0,portamento:0,envelope:{attack:2,attackCurve:"cosine",decay:.1,decayCurve:"linear",release:.2,releaseCurve:"cosine",sustain:.2},oscillator:{partialCount:5,partials:[1,.8434636622299384,.000244140625,.31640625,.0625],phase:8,type:"custom"}}).toDestination()}))}),[n]),Object(O.jsxs)("div",{className:"pv4",children:[Object(O.jsx)("div",{className:"image",children:Object(O.jsx)("img",{src:Z,alt:"Violin",style:{position:"absolute",top:window.innerHeight/16,left:window.innerWidth/8}})}),Object(O.jsx)("div",{className:"relative dib h4 w-100 ml4",children:Object(f.c)(3,4).map((function(e){return a.map((function(n){var i=-1!==n.note.indexOf("b"),a="".concat(n.note).concat(e+1);return i?null:Object(O.jsx)($,{note:a,synth:t,minor:i,octave:e+1,index:7*(e-2)+n.idx,topDi:125,leftDi:2*(7*(e-2)+n.idx)+20,rota:"rotate(1.5deg)"},a)}))}))}),Object(O.jsx)("div",{className:"relative dib h4 w-100 ml4",children:Object(f.c)(4,5).map((function(e){return a.map((function(n){var i=-1!==n.note.indexOf("b"),a="".concat(n.note).concat(e+1);return i?null:Object(O.jsx)($,{note:a,synth:t,minor:i,octave:e+1,index:7*(e-2)+n.idx,topDi:3,leftDi:2*(7*(e-2)+n.idx)+3,rota:"rotate(0deg)"},a)}))}))}),Object(O.jsx)("div",{className:"relative dib h4 w-100 ml4",children:Object(f.c)(5,6).map((function(e){return a.map((function(n){var i=-1!==n.note.indexOf("b"),a="".concat(n.note).concat(e+1);return i?null:Object(O.jsx)($,{note:a,synth:t,minor:i,octave:e+1,index:7*(e-2)+n.idx,topDi:-120,leftDi:2*(7*(e-2)+n.idx)-11,rota:"rotate(0deg)"},a)}))}))}),Object(O.jsx)("div",{className:"relative dib h4 w-100 ml4",children:Object(f.c)(6,7).map((function(e){return a.map((function(n){var i=-1!==n.note.indexOf("b"),a="".concat(n.note).concat(e+1);return i?null:Object(O.jsx)($,{note:a,synth:t,minor:i,octave:e+1,index:7*(e-2)+n.idx,topDi:-240,leftDi:2*(7*(e-2)+n.idx)-22,rota:"rotate(-1.5deg)"},a)}))}))})]})})),te=Object(f.a)([V,Q,ee]),ne=Object(f.a)([J,K,Y]),ie=Object(f.b)({instruments:te,visualizers:ne}),ae=n(4),ce=n(21),se=n(61),re=["error"],oe={transports:["websocket"],path:"/ws",autoConnect:!0,reconnection:!0,timeout:1e4},le=1;function de(e,t,n){return ue.apply(this,arguments)}function ue(){return(ue=Object(l.a)(o.a.mark((function e(t,n,i){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=le++,e.abrupt("return",new Promise((function(e,c){t.once("".concat(n,".").concat(a),(function(t){var n=t.error,i=Object(ce.a)(t,re);i?e(i):c(n)})),t.emit(n,Object(ae.a)({_id:a},i))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n(114);var be=function(){var e=Object(i.useReducer)(x,ie),t=Object(d.a)(e,2),n=t[0],a=t[1];return Object(i.useEffect)((function(){!function(e,t){var n=Object(se.io)("ws://localhost:3001",oe);n.on("connect",(function(){return e(n)})),n.on("disconnect",t)}(function(){var e=Object(l.a)(o.a.mark((function e(t){var n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(new v("SET_SOCKET",{socket:t})),e.next=3,de(t,"get_songs",{});case 3:n=e.sent,i=n.songs,a(new v("SET_SONGS",{songs:i}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(){a(new v("DELETE_SOCKET"))}))}),[]),Object(O.jsx)(u.a,{children:Object(O.jsxs)(b.c,{children:[Object(O.jsx)(b.a,{path:"/",children:Object(O.jsx)(F,{state:n,dispatch:a})}),Object(O.jsx)(b.a,{path:"/:instrument",children:Object(O.jsx)(F,{state:n,dispatch:a})}),Object(O.jsx)(b.a,{path:"*",children:Object(O.jsx)("div",{children:"404"})})]})})};n(115),n(116);var je=document.getElementById("root");s.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(be,{})}),je,(function(){console.log("React has loaded.")}))}},[[117,1,2]]]);
//# sourceMappingURL=main.5486bea7.chunk.js.map